WORKSHOP.REPARATION(reparation_id,name,received_date,delivery_date,
completion_date,problem_description,solution_description,
estate,status,device_id)ON [client] REFERENCIA res.partner (P)

WORKSHOP.REPARATION.DEVICE(device_id,device_type,model,brand,serial_number,reparation_id) ON [reparation_id] REFERENCIA workshop.reparation UNIQUE

WORKSHOP.REPARATION.TIMESHEET(date,description,time,reparation_id)

FOREIGN KEY(reparation_id) REFERENCES taula(campo)

DROP TABLE IF EXISTS workshop.reparation;

CREATE TABLE reparation(
	reparation_id INT NOT NULL PRIMARY KEY,
	name VARCHAR(50),
	received_date DATE,
	delivery_date DATE,
	completion_date DATE,
	problem_description VARCHAR(100) NOT NULL,
	solution_description VARCHAR(100),
	estate ENUM('closed','open') DEFAULT 'open',
	status ENUM('new', 'repairing','repaired', 'delivered','canceled') DEFAULT 'new',
);

ALTER TABLE reparation 
ADD COLUMN device_id INTEGER REFERENCES device(device_id) ON DELETE SET NULL;


CREATE TABLE device(
	device_id INT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
	device_type VARCHAR(50) NOT NULL,
	model VARCHAR(50) NOT NULL,
	brand VARCHAR(20) NOT NULL,
	serial_number VARCHAR(100) NOT NULL,
	fromOdoo BOOLEAN DEFAULT FALSE NOT NULL
)

ALTER TABLE device 
ADD COLUMN fromOdoo BOOLEAN DEFAULT FALSE;


CREATE TABLE timesheet(
	id INT GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
	date DATE NOT NULL,
	description VARCHAR(100) NOT NULL,
	time TIME NOT NULL,
	reparation_id INT,
	FOREIGN KEY(reparation_id) REFERENCES reparation(reparation_id)
);


